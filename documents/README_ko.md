# Sentinel-1 SAR를 활용한 산불 피해 면적 추정

## 개요

이 프로젝트는 **Sentinel-1 SAR 영상**을 이용해 **산불 피해 면적(burned area)**을 추정하는 것을 목표로 합니다.  
특히 다음과 같은 성격을 가진 **입문용 SAR 프로젝트**를 지향합니다.

- SAR를 처음 다루는 사람도 따라갈 수 있을 것
- 일반인에게도 결과가 직관적이고 시각적으로 이해되기 쉬울 것
- 너무 복잡한 이론보다는, 끝까지 돌아가는 깔끔한 파이프라인에 집중할 것

핵심 아이디어는 **산불 전·후 Sentinel-1 산란계수(backscatter)**를 비교해서  
변화 탐지(change detection)를 수행하고, 임계값 혹은 간단한 지도학습 모델로 **피해 영역을 분류**하는 것입니다.

---

## 목표

1. 1–3개의 산불 사례에 대해 Sentinel-1 SAR로 **산불 피해 면적**을 추정한다.
2. **시각적으로 이해하기 쉬운 결과물**을 만든다.
   - 베이스맵/광학 영상 위에 산불 피해 영역(마스크/폴리곤) 오버레이
   - 총 피해 면적(ha), 피해 비율(%) 등의 요약 통계
3. SAR 기반 피해 면적과 레퍼런스(참조) 데이터 간의 **정확도 평가**를 수행한다.
   - 공공기관에서 제공하는 산불 피해 폴리곤(있다면)
   - 혹은 고해상도 광학 영상으로 수작업 해석한 피해 영역
4. (선택) 두 가지 접근을 비교한다.
   - 단순 변화 + 임계값 방식
   - 간단한 지도학습 분류기(Random Forest 등)

가장 중요한 목표는 **처음부터 끝까지 한 번에 돌아가는, 재현 가능한 파이프라인을 완성하는 것**입니다.

---

## 왜 산불 + Sentinel-1 SAR인가?

- **주야·기상 조건에 관계없이 관측 가능**  
  SAR는 구름과 어느 정도의 연무/연기를 통과할 수 있어, 산불 직후에도 피해 영역을 볼 수 있습니다.
- **전 세계 무료 데이터**  
  Sentinel-1 GRD는 누구나 무료로 내려받아 사용할 수 있습니다.
- **지표 상태 변화에 민감**  
  산불은 식생 구조와 표면 거칠기를 크게 바꾸며, 이는 SAR 산란계수(σ⁰)에 변화를 일으킵니다.

따라서 Sentinel-1은 **산불 피해를 신속하게 매핑하는 데 적합**하며,  
SAR 입문 프로젝트로도 난이도가 적당한 주제입니다.

---

## 데이터

### 핵심 데이터

- **SAR 영상**
  - Sentinel-1 GRD (C-band)
  - 산불 사례마다 다음 두 시점의 영상 사용:
    - **산불 전(pre-fire)**: 산불 발생 며칠 전 영상
    - **산불 후(post-fire)**: 산불 직후 영상
  - 편파: VV, VH (가능한 경우 둘 다 사용)

- **레퍼런스 데이터** (정확도 평가용)
  - 산불 피해 폴리곤(공식 통계/공공데이터 등)  
    또는
  - Sentinel-2/상용 위성 등 고해상도 광학 영상에서 수작업으로 해석한 피해 영역

### 선택적 보조 데이터

- **광학 영상** (시각화 및 수작업 해석용)
  - Sentinel-2, Landsat, 상용 위성/지도 서비스 등

- **토지피복 데이터**
  - 비식생 지역(도시, 수면 등)을 미리 마스크해 오탐을 줄이는 데 활용

---

## 방법론

### 1. 사례 지역 선정

다음 조건을 만족하는 **산불 사례 1–3개**를 선택합니다.

- 광학 영상에서 피해 영역이 비교적 뚜렷하게 보일 것
- 산불 전·후에 적절한 Sentinel-1 패스가 존재할 것

### 2. Sentinel-1 전처리

SNAP, Google Earth Engine, Python 등의 환경에서 다음과 같은 전처리를 수행합니다.

1. Orbit 파일 적용
2. Thermal noise 제거
3. 방사 보정(Radiometric calibration) → σ⁰ (dB) 변환
4. Speckle 필터링 (예: Refined Lee)
5. 지형 보정(Terrain correction, 예: Range-Doppler)
6. 관심영역(AOI)로 subset

목표는 **지리적으로 보정된 VV/VH 산란계수 이미지(산불 전·후)**를 얻는 것입니다.

### 3. 특징(feature) 생성

산불 전·후 영상을 이용해 다음과 같은 특징을 만듭니다.

- 원시 산란계수(dB):
  - `VV_pre`, `VV_post`, `VH_pre`, `VH_post`
- 변화량 특징:
  - `dVV = VV_post - VV_pre`
  - `dVH = VH_post - VH_pre`
- (선택) 간단한 텍스처 특징
  - 3×3 혹은 5×5 근방 평균/표준편차 등

### 4. 방법 A: 변화 탐지 + 임계값 (MVP)

복잡한 ML 없이 구현 가능한 **최소 기능 버전**입니다.

1. 간단한 변화 지표 계산:
   - `change = dVV` 또는 `dVV + dVH` 등
2. 자동 임계값(Otsu 등)으로 “변화 있음” vs “변화 없음” 픽셀을 이진 분류
3. 후처리:
   - 너무 작은 패치 제거
   - 작은 구멍 메우기
   - (선택) 식생 지역으로만 마스크 제한

이 과정을 거치면 **산불 피해 영역 후보 마스크**를 얻을 수 있습니다.

### 5. 방법 B (선택): 지도학습 분류기

조금 난이도를 올리고 싶다면 간단한 지도학습을 추가할 수 있습니다.

1. 두 클래스에 대한 샘플 픽셀 수집:
   - Burned
   - Unburned
2. 사용 특징 예시:
   - `VV_pre`, `VV_post`, `VH_pre`, `VH_post`, `dVV`, `dVH`, (선택: 텍스처)
3. 간단한 분류기 학습:
   - Random Forest, XGBoost 등
4. 전체 이미지에 적용해 **burned 확률맵**과 최종 burned 마스크 생성

이렇게 하면 보고서에서  
“단순 변화 + 임계값 vs. 지도학습 분류기”의 성능 비교도 가능해집니다.

### 6. 정확도 평가

SAR로 추정한 피해 영역을 레퍼런스와 비교합니다.

- 픽셀 단위(또는 샘플 포인트 단위) 혼동행렬(confusion matrix) 계산
- 다음과 같은 지표 보고:
  - Overall accuracy
  - Burned 클래스에 대한 precision, recall, F1-score
  - 피해 영역 IoU(Intersection over Union)

---

## 시각화

이 프로젝트의 중요한 목표 중 하나는 **일반인도 이해하기 쉬운 시각화**입니다.

권장 결과물:

1. **전·후 비교 이미지**
   - 산불 전/후 optical 또는 SAR 이미지를  
     좌우 비교 혹은 스와이프 형태로 보여주기

2. **피해 영역 오버레이 지도**
   - 베이스맵 또는 광학 영상 위에  
     산불 피해 마스크/폴리곤을 붉은 반투명 레이어로 표시

3. **요약 통계 카드**
   - 총 피해 면적 (ha)
   - 전체 산림/식생 대비 피해 비율 (%)

이 정도만 구현해도, **비전문가에게도 “어디가 얼마나 불탔는지”를 직관적으로 보여줄 수 있습니다.**

---

## 예시 프로젝트 구조

```text
.
├── data/
│   ├── raw/          # 원본 Sentinel-1, 레퍼런스 데이터
│   ├── processed/    # 전처리된 SAR, 마스크 등
├── notebooks/
│   ├── 01_explore_data.ipynb
│   ├── 02_preprocessing.ipynb
│   ├── 03_change_detection.ipynb
│   ├── 04_classification_optional.ipynb
├── src/
│   ├── preprocessing.py
│   ├── features.py
│   ├── change_detection.py
│   ├── classification.py   # 선택
│   ├── evaluation.py
├── outputs/
│   ├── figures/
│   ├── maps/
│   └── reports/
└── README.md
```

이는 예시일 뿐이며,  
GEE 스크립트 위주, 노트북 위주 등 본인 스타일에 맞게 수정해서 사용할 수 있습니다.

---

## 시작하기

1. 사용할 환경/툴 체인 선택
   - SNAP GUI
   - Google Earth Engine
   - Python + SNAP/snappy/rasterio/xarray 등
2. 선택한 산불 사례에 대해 산불 전·후 Sentinel-1 GRD 다운로드
3. 기본 전처리 파이프라인 수행
4. **변화 탐지 + 임계값** 기반 MVP 먼저 구현
5. 평가 지표와 시각화 추가
6. (선택) 지도학습 분류기 방법 B 추가

---

## 향후 확장 아이디어

기본적인 피해 면적 추정 워크플로우가 완성되면, 다음과 같이 확장할 수 있습니다.

- 단순 burned/unburned가 아니라 **피해 심각도(severity)** 추정
- **기상 조건(풍속, 습도, 가뭄 지수 등)**과 피해 면적의 관계 분석
- 대상 지역 확대(여러 시즌, 여러 국가)
- U-Net, 시계열 딥러닝, 멀티센서 융합 등 고급 모델 적용

지금 단계에서는 우선 **Sentinel-1을 이용한 산불 피해 매핑 파이프라인을  
깔끔하고 이해하기 쉽게 만드는 것**을 최우선 목표로 합니다.
